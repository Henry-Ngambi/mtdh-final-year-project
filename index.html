  

<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Malawi Traditional Dances Hub</title>  
    <link rel="stylesheet" href="style.css"> 
    <link href="bootstrap.css" rel='stylesheet' type='text/css' /> 
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- jQuery -->  
</head>  
<body>  

<nav class="flex-div">  
    <div class="nav-left flex-div">  
        <img src="../public/images/menu1.png" class="menu-icon clicked" alt="Menu Icon">  
        <img src="../public/images/logo.png" class="logo" alt="MTDH">  
    </div>  
    <div class="nav-middle flex-div">  
        <div class="search-box flex-div">  
            <input type="text" placeholder="Search" id="searchInput">  
            <img src="../public/images/search.png" alt="Search Icon">  
            <div id="searchResults" style="position: absolute; top: 40px; background: #fff; width: 100%; max-height: 200px; overflow-y: auto; display: none;"></div>
        </div>  
    </div>  
    <div class="nav-right flex-div">  
        <div class="user-section">  
              
                  
                    <div class="profile-initials dropdown-toggle" data-toggle="dropdown">H</div>  
                  
                <div class="profile-card" id="profileCard">  
                    <h4>Henry Jonathan</h4>  
                    <a href="../user/manage-profile.php"><i class="fa fa-user"></i>Profile</a>  
                    <a href="../user/change-password.php"><i class="fa fa-cog"></i>Passwords</a>  
                    <a href="#" onclick="confirmLogout(event)"><i class="fa fa-sign-out"></i>Logout</a>  
                </div>  
              
        </div>  
    </div>  
</nav>  

<script>  
    $(document).ready(function() {
        // Toggle profile card on icon click
        $('.dropdown-toggle').click(function() {  
            $('#profileCard').toggle();
        });  

        // Hide profile card when clicking outside
        $(document).mouseup(function(e) {  
            var container = $("#profileCard");  
            if (!container.is(e.target) && container.has(e.target).length === 0) {  
                container.hide();  
            }  
        });

        // Menu icon color change on click
        $('.menu-icon').on('mousedown', function() {
            $(this).toggleClass('clicked');
        });

        // Toggle search box border color on focus
        $('#searchInput').on('focus', function() {
            $(this).parent('.search-box').addClass('active');
        }).on('blur', function() {
            $(this).parent('.search-box').removeClass('active');
        });

        // Real-time search with AJAX request
        $('#searchInput').on('input', function() {
            var query = $(this).val().toLowerCase();
            if (query.length > 0) {
                $.ajax({
                    url: 'search_videos.php',
                    type: 'GET',
                    data: { query: query },
                    success: function(response) {
                        $('#searchResults').show().html(response);
                    },
                    error: function() {
                        $('#searchResults').show().html('<p>An error occurred while searching.</p>');
                    }
                });
            } else {
                $('#searchResults').hide();
            }
        });
    });

    // Confirm logout
    function confirmLogout(event) {  
        event.preventDefault();  
        var confirmed = confirm("Are you sure you want to log out?");  
        if (confirmed) {  
            window.location.href = "../public/logout.php";  
        }  
    }  
</script>  

</body>  
</html>

<link rel="stylesheet" href="style.css">

<aside class="sidebar">
    <div class="shortcut-links">
        <a href="./index.php" class="active">
            <img src="../public/images/home.png"><p>Home</p>
        </a>
        <a href="trending.php" class="">
            <img src="../public/images/trending.png" class="icon"><p>Trending</p>
        </a>
        <a href="subscriptions.php" class="">
            <img src="../public/images/subscription.png"><p>Subscriptions</p>
        </a>
        <a href="events.php" class="">
            <img src="../public/images/event.png"><p>Events</p>
        </a>
        <a href="watch_live.php" class="">
            <img src="../public/images/live.png"><p>Watch Live</p>
        </a>
        <a href="explore.php" class="">
            <img src="../public/images/explore.png"><p>Explore</p>
        </a>
    </div>
    
    <hr>

    <div class="subscribed-list">
        <div class="categories">
            <p>Categories</p>
        </div>
        <a href="dances.php?region=northern" class="">
            <div class="icon">NM</div>
            <p>Northern Malawi</p>
        </a>
        <a href="dances.php?region=central" class="">
            <div class="icon">CM</div>
            <p>Central Malawi</p>
        </a>
        <a href="dances.php?region=southern" class="">
            <div class="icon">SM</div>
            <p>Southern Malawi</p>
        </a>
    </div>

</aside>

  

<link href="bootstrap.css" rel='stylesheet' type='text/css' />

<div class="container">  
    <div class="banner container">  
        <h1>Welcome To Malawi Traditional Dances Hub</h1>  
        <p>The Home of Cultural Dances</p>  
    </div>  

    <div class="success-message">Welcome, Henry Jonathan!</div>  

    <div class="list-container"></div> <!-- Container for dynamic video list -->

    <!-- Fetch and display About Us content -->
    
    <!-- Fetch and display Contact Us content -->
        
    <div class="about-contact-section">
        <div class="about-section">
            <h2 class="section-title">About Us</h2>
            <p><strong>Mission:</strong> At the Malawi Traditional Dances Hub (MTDH), our mission is to preserve, promote, and monetize Malawi’s rich traditional dance heritage. </p>
            <p><strong>What We Do:</strong> MTDH is dedicated to showcasing the diverse traditional dances of Malawi by providing tools for cultural groups to manage and promote their performances. </p>
            <p><strong>Our Team:</strong> Our team is composed of passionate individuals committed to promoting and preserving Malawi’s cultural identity. </p>
        </div>
        
        <div class="contact-section">
            <h2 class="section-title">Contact Us</h2>
            <p><i>For inquiries, please contact us through:

The Director of Tourism
Department Headquarters
Malawi Department of Tourism
Tourism House, Off Convention Drive
Private Bag 326,
City Centre,
Lilongwe, Malawi.

OR
</i></p>
            <p><strong>Email:</strong> mtdh@gmail.com</p>
            <p><strong>Mobile Number:</strong> +265888495631</p>
            <p><strong>Timing:</strong> Monday to Sunday : 24 hours available</p>
        </div>
    </div> 

</div>  

<script>  
document.addEventListener('DOMContentLoaded', function () {
    fetchVideos();

    function fetchVideos() {
        fetch('fetch_videos.php')
            .then(response => response.json())
            .then(data => {
                displayVideos(data);
            })
            .catch(error => {
                console.error('Error fetching videos:', error);
            });
    }

    function displayVideos(videos) {
        const listContainer = document.querySelector('.list-container');
        listContainer.innerHTML = ''; // Clear existing content

        videos.forEach(video => {
            const videoHtml = `
                <div class="vid-list">
                    <div class="flex-div">
                        <div class="vid-info">
                            <a href="video.php?id=${video.video_id}" class="video-overlay">
                                <video width="300" class="video-player" data-subscribed="false">
                                    <source src="${video.url}" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                                <div class="play-button-overlay">
                                    <img src="../public/images/play-button1.png" alt="Play" class="play-button-icon">
                                </div>
                            </a>
                            <div class="flex-div">
                                <a href="video.php?id=${video.video_id}"><h2>${toTitleCase(video.title)}</h2></a>
                            </div>
                            <h5>${toTitleCase(video.description)}, ${toTitleCase(video.category_name)}</h5>
                            <p>${video.views} views</p>
                            <p>${toTitleCase(timeElapsedString(video.created_at))}</p> 
                        </div>
                    </div>
                </div>
            `;
            listContainer.insertAdjacentHTML('beforeend', videoHtml);
        });

        // Add event listeners to video elements
        document.querySelectorAll('.video-player').forEach(video => {
            video.addEventListener('play', handleVideoPlay);
        });
    }

    function handleVideoPlay(event) {
        const video = event.target;
        const isSubscribed = video.getAttribute('data-subscribed') === 'true';

        if (!isSubscribed) {
            setTimeout(() => {
                video.pause();
                alert('Please subscribe to continue watching.');
            }, 10000); // Pause after 10 seconds
        } else {
            console.log("User is subscribed, no interruption needed.");
        }
    }

    function timeElapsedString(datetime) {
        const now = new Date();
        const ago = new Date(datetime); 
        const diff = now - ago;

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

        if (days > 0) return `${days} day${days > 1 ? 's' : ''} ago`;
        if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} ago`;
        if (minutes > 0) return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
        return 'just now';
    }

    function toTitleCase(str) {
        return str.toLowerCase().split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
    }

    function confirmLogout() {  
        if (confirm("Are you sure you want to logout?")) {  
            window.location.href = "../public/logout.php";  
        }  
    }
});
</script>

<!-- MTDH System/user/footer.php -->

<script src="script.js"></script>
</body>
</html>
  
